lm(
formula = body_length ~ body_mass,
data = dat_delo)
fit2  =
lm(
formula = body_mass ~ sex,
data = dat_delo)
fit3 =
lm(
formula = body_mass ~ binomial,
data = dat_delo)
fit4 =
lm(
formula = body_mass ~ sex + binomial,
data = dat_delo)
fit5 =
lm(
formula = body_mass ~ sex * binomial,
data = dat_delo)
hist(residuals(fit1))
#Histograms of model residuals
hist(residuals(fit1), main = "Histogram of residuals fit 1", xlab = "Residuals (fit 1)", col = "pink")
#Histograms of model residuals
par(mfrow = c(5, 1), mar = c(4,3,3,1))
hist(residuals(fit1), main = "Histogram of residuals fit 1", xlab = "Residuals (fit 1)", col = "pink")
hist(residuals(fit2), main = "Histogram of residuals fit 2", xlab = "Residuals (fit 2)", col = "steelblue")
hist(residuals(fit3), main = "Histogram of residuals fit 3", xlab = "Residuals (fit 3)", col = "red")
hist(residuals(fit4), main = "Histogram of residuals fit 4", xlab = "Residuals (fit 4)", col = "black")
hist(residuals(fit5), main = "Histogram of residuals fit 5", xlab = "Residuals (fit 5)", col = "green")
#Histograms of model residuals
par(mfrow = c(5, 1), mar = c(4,3,3,1))
hist(residuals(fit1), main = "Histogram of residuals fit 1", xlab = "Residuals (fit 1)", col = "pink")
hist(residuals(fit2), main = "Histogram of residuals fit 2", xlab = "Residuals (fit 2)", col = "steelblue")
hist(residuals(fit3), main = "Histogram of residuals fit 3", xlab = "Residuals (fit 3)", col = "red")
hist(residuals(fit4), main = "Histogram of residuals fit 4", xlab = "Residuals (fit 4)")
hist(residuals(fit5), main = "Histogram of residuals fit 5", xlab = "Residuals (fit 5)", col = "green")
#Histograms of model residuals
par(mfrow = c(5, 1), mar = c(4,3,3,1))
hist(residuals(fit1), main = "Histogram of residuals fit 1", xlab = "Residuals (fit 1)", col = "pink")
hist(residuals(fit2), main = "Histogram of residuals fit 2", xlab = "Residuals (fit 2)", col = "steelblue")
hist(residuals(fit3), main = "Histogram of residuals fit 3", xlab = "Residuals (fit 3)", col = "red")
hist(residuals(fit4), main = "Histogram of residuals fit 4", xlab = "Residuals (fit 4)")
hist(residuals(fit5), main = "Histogram of residuals fit 5", xlab = "Residuals (fit 5)", col = "green")
#Histograms of model residuals
par(mfrow = c(5, 1), mar = c(4,3,3,1))
hist(residuals(fit1), main = "Histogram of residuals fit 1", xlab = "Residuals (fit 1)", col = "pink")
hist(residuals(fit2), main = "Histogram of residuals fit 2", xlab = "Residuals (fit 2)", col = "steelblue")
hist(residuals(fit3), main = "Histogram of residuals fit 3", xlab = "Residuals (fit 3)", col = "red")
hist(residuals(fit4), main = "Histogram of residuals fit 4", xlab = "Residuals (fit 4)")
hist(residuals(fit5), main = "Histogram of residuals fit 5", xlab = "Residuals (fit 5)", col = "green")
#Histograms of model residuals
par(mfrow = c(5, 1), mar = c(4,3,3,1))
hist(residuals(fit1), main = "Histogram of residuals fit 1", xlab = "Residuals (fit 1)", col = "pink")
hist(residuals(fit2), main = "Histogram of residuals fit 2", xlab = "Residuals (fit 2)", col = "steelblue")
hist(residuals(fit3), main = "Histogram of residuals fit 3", xlab = "Residuals (fit 3)", col = "red")
hist(residuals(fit4), main = "Histogram of residuals fit 4", xlab = "Residuals (fit 4)")
hist(residuals(fit5), main = "Histogram of residuals fit 5", xlab = "Residuals (fit 5)", col = "green")
#Shapiro Test fit 1
shapiro.test(residuals(fit1))
#Shapiro Test fit 2
shapiro.test(residuals(fit2))
#Shapiro Test fit 3
shapiro.test(residuals(fit3))
#Shapiro Test fit 4
shapiro.test(residuals(fit4))
#Shapiro Test fit 5
shapiro.test(residuals(fit5))
require(here)
rm(list = ls())
rope = read.csv(here("data", "rope.csv"))
rope$rope.type = factor(rope$rope.type)
rope_names <- levels(rope$rope.type)
rope$rope.type
n_obs = nrow(rope)
boxplot(p.cut ~ rope.type, data = rope)
n_groups = length(rope_names)
#SS Tot for p.cut
mean_pcut <- mean(rope$p.cut)
p_resids <- rope$p.cut - mean_pcut
squ_resids <- p_resids^2
sum_presids <- sum(squ_resids)
ss_tot = sum(squ_resids)
agg_resids <- aggregate(
x = rope$p.cut,
by = list(rope$rope.type),
FUN = function(x) x-mean(x))
str(agg_resids)
agg_sum_sq_resids <- aggregate(
x = rope$p.cut,
by = list(rope$rope.type),
FUN = function(x) sum((x - mean(x))^2))
str(agg_sum_sq_resids)
ss_within <- sum(agg_sum_sq_resids$x)
ss_among = ss_tot - ss_within
df_tot = n_obs - 1
df_within = n_obs - n_groups
df_among = n_groups - 1
ms_among  =  ss_among / (n_groups - 1)
ms_within = ss_within / (n_obs - n_groups)
f_ratio =  ms_among / ms_within
f_pval =  1 - pf(f_ratio, df_among, df_within)
# number comparison tolerance
digits_check = 5
# Build the reference model using R functions
fit_1 = lm(p.cut ~ rope.type, data=rope)
anova(fit_1)
anova_fit_1 = anova(fit_1)
anova_fit_1$"Sum Sq"
# Check degrees of freedom
anova_fit_1$Df == c(df_among, df_within)
# Check sums of squares
round(anova_fit_1$`Sum Sq`, digits = digits_check) == round(c(ss_among, ss_within), digits = digits_check)
# Check mean squares
round(anova_fit_1$`Mean Sq`, digits = digits_check) == round(c(ms_among, ms_within), digits = digits_check)
# Check the F-ratio
round(anova_fit_1$`F value`[1], digits = digits_check) == round(f_ratio, digits = digits_check)
# Check the F test statistic p-value
round(anova_fit_1$`Pr(>F)`[1], digits = digits_check) == round(f_pval, digits = digits_check)
rope2 = droplevels(
subset(
rope,
rope.type %in% c("PI", "VEL", "XTC"))
)
boxplot(
p.cut ~ rope.type,
data = rope2,
las = 2,
xlab = "",
ylab = "Proportion Rope Cut",
main = "Subset of Rope Data")
mtext("Rope Type", side = 1, line = 3)
fit_rope_2 = lm(p.cut ~ rope.type, data=rope2)
rope2_hsd = TukeyHSD(aov(fit_rope_2))
class(rope2_hsd)
round(rope2_hsd$rope.type, digits = 4)
#Building models for ANOVA
fit1 =
lm(
formula = body_length ~ body_mass,
data = dat_delo)
require(here)
library(palmerpenguins)
require(palmerpenguins)
here()
ginkgo <- read.csv(here("data", "ginkgo_data_2022.csv"))
dat_delo <- read.csv(here("data", "delomys.csv"))
dat_pen <- penguins
require(palmerpenguins)
plot(body_length ~ body_mass, data = dat_delo, main = "Delomys Body Mass and Body Length Histogram", xlab = "Body Mass", ylab = "Body Length", col = "black")
#Histogram of Penguin Body Mass and Body Length
par(mfrow = c(2, 1))
hist(dat_pen$body_mass_g, main = "Delomys Body Mass Histogram", xlab = "Body Mass", col = "pink")
hist(dat_delo$body_length, xlab = "Body Length",main = "Delomys Penguin Body Length Histogram", col = "steelblue")
dat_delo_1 = lm(body_mass ~ body_length, data = dat_delo)
summary(dat_delo_1)
shapiro.test(residuals(dat_delo_1))
# Conditional Box Plots
#1. Conditional boxplot of body mass, conditioned on species (column binomial)
par(mfrow = c(3, 1), mar = c(5,3,3,1))
boxplot(body_mass~binomial,data = dat_delo, main = "Delomys Body Mass Conditioned on Species", col = "red", xlab = "Species", ylab = "Body Mass")
boxplot(body_mass~sex,data = dat_delo, main = "Delomys Body Mass Conditioned on Sex", col = "pink", xlab = "Sex", ylab = "Body Mass")
boxplot(body_mass~binomial+sex,data = dat_delo, main = "Delomys Body Mass Conditioned on Species & Sex", col = "steelblue", xlab = "Species", ylab = "Body Mass", names = c("Female\n Delomys\n Dorsalis", "Female\n Delomys\n Sublineatus", "Male\n Delomys\n Dorsalis", "Male\n Delomys\n Sublineatus"), las = 2)
#Building models for ANOVA
fit1 =
lm(
formula = body_length ~ body_mass,
data = dat_delo)
summary(fit1)
fit2  =
lm(
formula = body_mass ~ sex,
data = dat_delo)
summary(fit2)
fit3 =
lm(
formula = body_mass ~ binomial,
data = dat_delo)
summary(fit3)
fit4 =
lm(
formula = body_mass ~ sex + binomial,
data = dat_delo)
summary(fit4)
fit5 =
lm(
formula = body_mass ~ sex * binomial,
data = dat_delo)
summary(fit5)
#Histograms of model residuals
par(mfrow = c(5, 1), mar = c(4,3,3,1))
hist(residuals(fit1), main = "Histogram of residuals fit 1", xlab = "Residuals (fit 1)", col = "pink")
hist(residuals(fit2), main = "Histogram of residuals fit 2", xlab = "Residuals (fit 2)", col = "steelblue")
hist(residuals(fit3), main = "Histogram of residuals fit 3", xlab = "Residuals (fit 3)", col = "red")
hist(residuals(fit4), main = "Histogram of residuals fit 4", xlab = "Residuals (fit 4)")
hist(residuals(fit5), main = "Histogram of residuals fit 5", xlab = "Residuals (fit 5)", col = "green")
fit1 =
lm(
formula = body_length ~ body_mass,
data = dat_delo)
anova(fit1)
#Building models for ANOVA
fit1 =
lm(
formula = body_length ~ body_mass,
data = dat_delo)
anova_fit1 = anova(fit1)
str(anova_fit1)
#Building models for ANOVA
fit1 =
lm(
formula = body_length ~ body_mass,
data = dat_delo)
anova(fit_1)
#Building models for ANOVA
fit1 =
lm(
formula = body_length ~ body_mass,
data = dat_delo)
anova(fit11)
#Building models for ANOVA
fit1 =
lm(
formula = body_length ~ body_mass,
data = dat_delo)
anova(fit1)
anova(fit1)
fit2  =
lm(
formula = body_mass ~ sex,
data = dat_delo)
anova(fit2)
#Building models for ANOVA
fit1 =
lm(
formula = body_length ~ body_mass,
data = dat_delo)
coef(fit1)
slope_observed = coef(fit1)
plot(
body_length ~ body_mass, data = dat_delo,
main = "",
xlab = "Vegetation cover diversity",
ylab = "Bird diversity")
abline(fit_1)
plot(
body_length ~ body_mass, data = dat_delo,
main = "",
xlab = "Vegetation cover diversity",
ylab = "Bird diversity")
abline(fit1)
plot(
body_mass~body_length, data = dat_delo,
main = "",
xlab = "Body Mass",
ylab = "Body Length")
abline(fit1)
fit1 =
lm(
formula = body_length ~ body_mass,
data = dat_delo)
coef(fit1)
slope_observed = coef(fit1)
plot(
body_length ~ body_mass, data = dat_delo,
main = "",
xlab = "Body Length",
ylab = "Body Mass")
abline(fit1)
fit3 =
lm(
formula = body_mass ~ binomial,
data = dat_delo)
anova(fit3)
fit4 =
lm(
formula = body_mass ~ sex + binomial,
data = dat_delo)
anova(fit4)
fit5 =
lm(
formula = body_mass ~ sex * binomial,
data = dat_delo)
anova(fit5)
knitr::kable(coef(summary(my_model_fit)))
knitr::kable(coef(summary(fit5)))
knitr::kable(coef(summary(fit5)), digits = 2)
summary(coef(summary(fit5)), digits = 2))
summary(knitr::kable(coef(summary(fit5)), digits = 2)
summary((coef(summary(fit5)), digits = 2)
knitr::kable(coef(summary(my_model_fit)), digits = 2)
knitr::kable(coef(summary(fit5)), digits = 2)
knitr::kable(coef(summary(dat_delo)), digits = 2)
knitr::kable(coef(summary(dat_delo$body_mass~body_length)), digits = 2)
coef(fit2)
coef(dat_delo$sex)
sex = dat_delo$sex
sex = dat_delo$sex
coef(sex)
coef(fit2)
coef(fit3)
coef(fit4)
fit6 =
lm(
formula = body_mass ~ binomial,
data = dat_delo)
coef(fit6)
fit6 =
lm(
formula = body_mass ~ binomial,
data = dat_delo)
coef(fit6)
summary(fit6)
require(here)
library(palmerpenguins)
require(palmerpenguins)
here()
ginkgo <- read.csv(here("data", "ginkgo_data_2022.csv"))
require(here)
library(palmerpenguins)
require(palmerpenguins)
here()
ginkgo <- read.csv(here("data", "ginkgo_data_2022.csv"))
ginkgo <- read.csv(here("data", "ginkgo_data_2022.csv"))
dat_delo <- read.csv(here("data", "delomys.csv"))
dat_pen <- penguins
require(palmerpenguins)
plot(body_length ~ body_mass, data = dat_delo, main = "Delomys Body Mass and Body Length Histogram", xlab = "Body Mass", ylab = "Body Length", col = "black")
#Histogram of Penguin Body Mass and Body Length
par(mfrow = c(2, 1))
hist(dat_pen$body_mass_g, main = "Delomys Body Mass Histogram", xlab = "Body Mass", col = "pink")
hist(dat_delo$body_length, xlab = "Body Length",main = "Delomys Penguin Body Length Histogram", col = "steelblue")
dat_delo_1 = lm(body_mass ~ body_length, data = dat_delo)
summary(dat_delo_1)
shapiro.test(residuals(dat_delo_1))
# Conditional Box Plots
#1. Conditional boxplot of body mass, conditioned on species (column binomial)
par(mfrow = c(3, 1), mar = c(5,3,3,1))
boxplot(body_mass~binomial,data = dat_delo, main = "Delomys Body Mass Conditioned on Species", col = "red", xlab = "Species", ylab = "Body Mass")
boxplot(body_mass~sex,data = dat_delo, main = "Delomys Body Mass Conditioned on Sex", col = "pink", xlab = "Sex", ylab = "Body Mass")
boxplot(body_mass~binomial+sex,data = dat_delo, main = "Delomys Body Mass Conditioned on Species & Sex", col = "steelblue", xlab = "Species", ylab = "Body Mass", names = c("Female\n Delomys\n Dorsalis", "Female\n Delomys\n Sublineatus", "Male\n Delomys\n Dorsalis", "Male\n Delomys\n Sublineatus"), las = 2)
#Building models for ANOVA
fit1 =
lm(
formula = body_length ~ body_mass,
data = dat_delo)
coef(fit1)
slope_observed = coef(fit1)
plot(
body_length ~ body_mass, data = dat_delo,
main = "",
xlab = "Body Length",
ylab = "Body Mass")
abline(fit1)
fit2  =
lm(
formula = body_mass ~ sex,
data = dat_delo)
anova(fit2)
fit3 =
lm(
formula = body_mass ~ binomial,
data = dat_delo)
anova(fit3)
fit4 =
lm(
formula = body_mass ~ sex + binomial,
data = dat_delo)
anova(fit4)
fit5 =
lm(
formula = body_mass ~ sex * binomial,
data = dat_delo)
anova(fit5)
#Histograms of model residuals
par(mfrow = c(5, 1), mar = c(4,3,3,1))
hist(residuals(fit1), main = "Histogram of residuals fit 1", xlab = "Residuals (fit 1)", col = "pink")
hist(residuals(fit2), main = "Histogram of residuals fit 2", xlab = "Residuals (fit 2)", col = "steelblue")
hist(residuals(fit3), main = "Histogram of residuals fit 3", xlab = "Residuals (fit 3)", col = "red")
hist(residuals(fit4), main = "Histogram of residuals fit 4", xlab = "Residuals (fit 4)")
hist(residuals(fit5), main = "Histogram of residuals fit 5", xlab = "Residuals (fit 5)", col = "green")
#Shapiro Test fit 1
shapiro.test(residuals(fit1))
#Shapiro Test fit 2
shapiro.test(residuals(fit2))
#Shapiro Test fit 3
shapiro.test(residuals(fit3))
#Shapiro Test fit 4
shapiro.test(residuals(fit4))
#Shapiro Test fit 5
shapiro.test(residuals(fit5))
knitr::kable(coef(summary()), digits = 2)
require(here)
library(palmerpenguins)
require(palmerpenguins)
here()
ginkgo <- read.csv(here("data", "ginkgo_data_2022.csv"))
require(here)
library(palmerpenguins)
require(palmerpenguins)
here()
ginkgo <- read.csv(here("data", "ginkgo_data_2022.csv"))
dat_delo <- read.csv(here("data", "delomys.csv"))
dat_pen <- penguins
require(palmerpenguins)
plot(body_length ~ body_mass, data = dat_delo, main = "Delomys Body Mass and Body Length Histogram", xlab = "Body Mass", ylab = "Body Length", col = "black")
#Histogram of Penguin Body Mass and Body Length
par(mfrow = c(2, 1))
hist(dat_pen$body_mass_g, main = "Delomys Body Mass Histogram", xlab = "Body Mass", col = "pink")
hist(dat_delo$body_length, xlab = "Body Length",main = "Delomys Penguin Body Length Histogram", col = "steelblue")
dat_delo_1 = lm(body_mass ~ body_length, data = dat_delo)
summary(dat_delo_1)
shapiro.test(residuals(dat_delo_1))
# Conditional Box Plots
#1. Conditional boxplot of body mass, conditioned on species (column binomial)
par(mfrow = c(3, 1), mar = c(5,3,3,1))
boxplot(body_mass~binomial,data = dat_delo, main = "Delomys Body Mass Conditioned on Species", col = "red", xlab = "Species", ylab = "Body Mass")
boxplot(body_mass~sex,data = dat_delo, main = "Delomys Body Mass Conditioned on Sex", col = "pink", xlab = "Sex", ylab = "Body Mass")
boxplot(body_mass~binomial+sex,data = dat_delo, main = "Delomys Body Mass Conditioned on Species & Sex", col = "steelblue", xlab = "Species", ylab = "Body Mass", names = c("Female\n Delomys\n Dorsalis", "Female\n Delomys\n Sublineatus", "Male\n Delomys\n Dorsalis", "Male\n Delomys\n Sublineatus"), las = 2)
#Building models for ANOVA
fit1 =
lm(
formula = body_length ~ body_mass,
data = dat_delo)
coef(fit1)
slope_observed = coef(fit1)
plot(
body_length ~ body_mass, data = dat_delo,
main = "",
xlab = "Body Length",
ylab = "Body Mass")
abline(fit1)
fit2  =
lm(
formula = body_mass ~ sex,
data = dat_delo)
anova(fit2)
fit3 =
lm(
formula = body_mass ~ binomial,
data = dat_delo)
anova(fit3)
fit4 =
lm(
formula = body_mass ~ sex + binomial,
data = dat_delo)
anova(fit4)
fit5 =
lm(
formula = body_mass ~ sex * binomial,
data = dat_delo)
anova(fit5)
#Histograms of model residuals
par(mfrow = c(5, 1), mar = c(4,3,3,1))
hist(residuals(fit1), main = "Histogram of residuals fit 1", xlab = "Residuals (fit 1)", col = "pink")
hist(residuals(fit2), main = "Histogram of residuals fit 2", xlab = "Residuals (fit 2)", col = "steelblue")
hist(residuals(fit3), main = "Histogram of residuals fit 3", xlab = "Residuals (fit 3)", col = "red")
hist(residuals(fit4), main = "Histogram of residuals fit 4", xlab = "Residuals (fit 4)")
hist(residuals(fit5), main = "Histogram of residuals fit 5", xlab = "Residuals (fit 5)", col = "green")
#Shapiro Test fit 1
shapiro.test(residuals(fit1))
#Shapiro Test fit 2
shapiro.test(residuals(fit2))
#Shapiro Test fit 3
shapiro.test(residuals(fit3))
#Shapiro Test fit 4
shapiro.test(residuals(fit4))
#Shapiro Test fit 5
shapiro.test(residuals(fit5))
knitr::kable(coef(summary(fit1)), digits = 2)
knitr::kable(coef(summary(fit1)), digits = 2)
coef(fit_1)
knitr::kable(coef(summary(fit1)), digits = 2)
coef(fit1)
slope_observed = coef(fit1)[2]
coef(fit1)
coef(fit1)
knitr::kable(coef(summary(fit1)), digits = 2)
knitr::kable(coef(summary(fit2)), digits = 2)
coef(fit2)
knitr::kable(coef(summary(fit3)), digits = 2)
coef(fit3)
coef(fit2)
fit6 =
lm(
formula = body_mass ~ binomial,
data = dat_delo)
coef(fit6)
summary(fit6)
require(palmerpenguins)
require(here)
require(boot)
dat_pen = droplevels(subset(penguins, species != "Gentoo"))
{
boxplot(
flipper_length_mm ~ species, data = dat_pen,
ylab = "Flipper length (mm)")
}
#Parametric Two-Sample Test
t.test(flipper_length_mm ~ species, data = dat_pen, alternative = "less")
#Bootstrap Two-Sample Test
#install.packages("simpleboot")
require(simpleboot)
#Use two.boot
dat_ad <- subset(dat_pen,species == "Adelie", select = "flipper_length_mm")
dat_chin <- subset(dat_pen, species == "Chinstrap", select = "flipper_length_mm")
pen_boot <- two.boot(na.omit(dat_ad$flipper_length_mm), na.omit(dat_chin$flipper_length_mm), FUN = mean , R= 10000)
mean(quantile(
pen_boot$t,
c(0.025, 0.975)))
median(quantile(
pen_boot$t,
c(0.025, 0.975)))
