"0","alpha = 0.05"
"0","n_sims = 30"
"0","p_vals = numeric(n_sims)"
"0",""
"0","sample_sizes = seq(5, 20)"
"0","sample_size_powers = numeric(length(sample_sizes))"
"0",""
"0","# The maximum x value in the simulation."
"0","# Use the maximum observed x-value in the data"
"0","max_x = max(birdhab$ls)"
"0",""
"0","linear = function(x, y_int, slope)"
"0","{"
"0","  return(x*slope + y_int)"
"0","  "
"0","}"
"0",""
"0","linear(x = 1, y_int = 1, slope = 1)"
"1","[1]"
"1"," 2"
"1","
"
"0","linear(x = 3:5, y_int = 1, slope = 1)"
"1","[1]"
"1"," 4"
"1"," 5"
"1"," 6"
"1","
"
"0","linear(x = 3:5, y_int = -1, slope = 1)"
"1","[1]"
"1"," 2"
"1"," 3"
"1"," 4"
"1","
"
"0","linear(x = 3:5, y_int = -1, slope = 0.01)"
"1","[1]"
"1"," -0.97"
"1"," -0.96"
"1"," -0.95"
"1","
"
"0","linear_simulator = function (x, y_int, slope, st_dev)"
"0","{"
"0"," "
"0","  int_1 <- linear(x, y_int, slope)"
"0","  noise <- rnorm(n = length(x), mean = 0, sd = st_dev)"
"0","  noisy_line <- int_1 + noise"
"0","  "
"0","  return(noisy_line)"
"0","  "
"0","}"
"0",""
"0","linear_sim_fit = function(x, slope, y_int, st_dev)"
"0","{"
"0","  y_sim = linear_simulator("
"0","    x = x,"
"0","    y_int = y_int,"
"0","    slope = slope,"
"0","    st_dev = st_dev"
"0","  )"
"0","  fit_sim = lm(y_sim ~ x)"
"0","  return(fit_sim)"
"0","}"
"0",""
"0",""
"0","for(j in 1:length(sample_sizes))"
"0","{"
"0","  # A sequence of equally-spaced x-values:"
"0","  x_vals = seq(0, max_x, length.out = sample_sizes[j])"
"0","  "
"0","  for(i in 1:n_sims)"
"0","  {"
"0","    fit_sim = linear_sim_fit("
"0","      x = x_vals,"
"0","      y_int = int_obs,"
"0","      slope = slope_obs,"
"0","      st_dev = sd_obs"
"0","    )"
"0","    p_vals[i] = summary(fit_sim)$coefficients[2, 'Pr(>|t|)']"
"0","  }"
"0","  sample_size_powers[j] = sum(p_vals < alpha) / n_sims"
"0","}"
"0",""
"0",""
"0","sim_sample_size = "
"0","  data.frame("
"0","    sample_size = sample_sizes,"
"0","    power       = sample_size_powers)"
"0",""
"0","plot("
"0","  power ~ sample_size, data = sim_sample_size,"
"0","  type = 'l', xlab = 'Sample size', ylab = 'Power')"
"0",""
